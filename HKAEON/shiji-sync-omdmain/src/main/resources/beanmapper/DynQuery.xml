<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mybatis.sql">	
	<!--
	    JDBC类型和Java类型对照表
	    JDBC Type           Java Type
	    ==================================================  
	      CHAR                String  
	      VARCHAR             String  
	      LONGVARCHAR         String  
	      NUMERIC             java.math.BigDecimal  
	      DECIMAL             java.math.BigDecimal  
	      BIT                 boolean  
	      BOOLEAN             boolean  
	      TINYINT             byte  
	      SMALLINT            short  
	      INTEGER             int  
	      BIGINT              long  
	      REAL                float  
	      FLOAT               double  
	      DOUBLE              double  
	      BINARY              byte[]  
	      VARBINARY           byte[]  
	      LONGVARBINARY       byte[]  
	      DATE                java.sql.Date  
	      TIME                java.sql.Time  
	      TIMESTAMP           java.sql.Timestamp  
	      CLOB                Clob  
	      BLOB                Blob  
	      ARRAY               Array  
	      DISTINCT            mapping of underlying type  
	      STRUCT              Struct  
	      REF                 Ref  
	      DATALINK            java.net.URL   
	    ==================================================  
	 -->
	<select id="select" parameterType="String" resultType="map">
    	${value}
	</select>

	<select id="insert" parameterType="String" resultType="map">
    	${value}
	</select>

	<select id="update" parameterType="String" resultType="map">
    	${value}
	</select>

	<select id="delete" parameterType="String" resultType="map">
    	${value}
	</select>
	

	<!-- 功能保留：在执行所有SQL前都需要执行上下文,是数据范围控制的基础 -->
	<select id="context" parameterType="String" resultType="map" statementType="CALLABLE">
		<![CDATA[{call Sp_Applypolicy(
			#{In_EntId,mode=IN,jdbcType=BIGINT},
			#{In_Shop ,mode=IN,jdbcType=VARCHAR},
			#{IN_CCID ,mode=IN,jdbcType=VARCHAR}}
		)}]]>
	</select>
	
	<!-- 在执行所有SQL前都需要执行上下文,是数据范围控制的基础 -->
	<select id="setcontext" parameterType="MapCase" resultType="map" statementType="CALLABLE">
		<!-- <![CDATA[{call Sp_Applypolicy(
			#{entID   ,mode=IN,jdbcType=BIGINT},
			#{shopcode,mode=IN,jdbcType=VARCHAR},
			#{usercode,mode=IN,jdbcType=VARCHAR}}
		)}]]> -->
		select #{entID} as entID,#{shopcode} as shopcode,#{usercode} as usercode from dual
	</select>
	
	<!-- 在执行所有SQL前都需要执行上下文 -->
    <select id="setcontext2" parameterMap="setContextMap" statementType="CALLABLE">
        CALL Sp_Applypolicy(?,?,?)
    </select>
    
    <parameterMap type="java.util.Map" id="setContextMap">
        <parameter property="entID"    mode="IN" jdbcType="BIGINT"/>
        <parameter property="shopcode" mode="IN" jdbcType="VARCHAR"/>
        <parameter property="usercode" mode="IN" jdbcType="VARCHAR"/>
    </parameterMap>	
	
    <!--
        parameterMap.put("entID", 0);
        parameterMap.put("shopcode", "A0001");
        parameterMap.put("usercode", "system");
     -->

	<!-- 在执行所有SQL前都需要执行上下文,是数据范围控制的基础 -->
	<select id="clearcontext" parameterType="String" resultType="MapCase" statementType="CALLABLE">
		<![CDATA[{call Sp_Clearpolicy()}]]>
	</select>	
</mapper>

